function scrollToTop(){return $("html, body").animate({scrollTop:0},500),!1}function scrollToAnchor(a){var b=$("#"+a),c=0;return"fixed"===$menu.css("position")&&(c+=$menu.height()),"fixed"===$astralBanner.css("position")&&(c+=$astralBanner.height()),$("html, body").animate({scrollTop:$(b).offset().top-c},500),!1}function showProject(a){projectVM.slug(a),$projectNode.style.display="block",$homeNode.style.display="none"}function showHome(a){window.location.hash="/home",$projectNode.style.display="none",$homeNode.style.display="block",void 0!==a&&scrollToAnchor(a)}function Project(a,b,c,d,e,f,g){var h=this;h.id=a,h.slug=b,h.name=c,h.description=d,h.tags=e,h.featureMedia=f,h.featureMediaUrl=ko.observable(),h.media=g}function Tag(a,b){var c=this;c.id=a,c.name=b}function Media(a,b,c){var d=this;d.content=a,d.description=b,d.type=c}function StartViewModel(){var a=3,b=this;b.tags=ko.observableArray(),b.projects=ko.observableArray(),b.introText=ko.observable(),b.footer=ko.observableArray(),b.selectedTags=ko.observableArray(),b.visibleImageUrl=ko.observable(),b.getSelectedProjects=function(){if(b.selectedTags()&&0!==b.selectedTags().length){var c=ko.utils.arrayFilter(b.projects(),function(a){var c;return jQuery.map(a.tags,function(a){-1!==b.selectedTags().indexOf(a)&&(c=!0)}),c});return SplitArrayIntoN(c,a)}return SplitArrayIntoN(b.projects(),a)},b.selectedProjects=ko.computed(b.getSelectedProjects),b.getTags=function(){jQuery.get("/wp-json/wp/v2/project_tag",null,function(a){var c=jQuery.map(a,function(a){return tagList[a.id]=new Tag(a.id,a.name),tagList[a.id]});b.tags(c)})},b.getProjects=function(a){jQuery.get("//astr.nsur.org/wp-json/wp/v2/project?per_page=99",null,function(c){var d=jQuery.map(c,function(b){var c=jQuery.map(b.project_tag,function(b){return a[b]});return new Project(b.id,b.slug,b.acf.display_name,null,c,b.acf.feature_image,null)});b.projects(d)})},b.getConfig=function(){jQuery.get("/wp-json/wp/v2/config/174",null,function(a){b.introText(a.acf.heading);var c=jQuery.map(a.acf.footer,function(a){var b=[];return b.push(jQuery.map(a.column,function(a){return{heading:a.heading,content:a.content}})),b});b.footer(c)})},b.getImage=function(a){jQuery.get("/wp-json/wp/v2/media/"+a,null,function(a){b.visibleImageUrl(a.media_details.sizes.thumbnail.source_url)})},b.showFeaturedImage=function(a,c){null!=a.featureMedia&&0!=a.featureMedia&&(b.getImage(a.featureMedia),a.featureMediaUrl(b.visibleImageUrl())),jQuery(".projectImage").css({position:"absolute",top:c.pageY-70,left:c.pageX-30})},b.hideFeaturedImage=function(a){b.visibleImageUrl(null)},b.getTags(),b.getProjects(tagList),b.getConfig()}function ProjectViewModel(){var a=this;a.slug=ko.observable(),a.project=ko.observable(),a.getProject=ko.computed(function(){return void 0===a.slug()?!1:void jQuery.get("/wp-json/wp/v2/project/?slug="+a.slug(),null,function(b){b=b[0];var c=jQuery.map(b.project_tag,function(a){return tagList[a]}),d=jQuery.map(b.acf.media,function(a){if("picture"==a.acf_fc_layout){var b;return jQuery.ajax({url:"/wp-json/wp/v2/media/"+a.image,success:function(a){b=a.media_details.sizes.medium.source_url},async:!1}),new Media(b,a.image_description,a.acf_fc_layout)}return"video"==a.acf_fc_layout?new Media(a.video_url,a.video_description,a.acf_fc_layout):void 0}),e=new Project(b.id,b.slug,b.acf.display_name,b.acf.description,c,null,d);console.log(e),a.project(e)})})}function SplitArrayIntoN(a,b){var c,d,e=[],f=Math.ceil(a.length/b),g=Math.floor(a.length/b);for(c=0,d=a.length;d>c;c+=f)0!=c&&(f=g),e.push(a.slice(c,c+f));return e}var tagList={},$projectNode=document.getElementById("project"),$homeNode=document.getElementById("home"),$menu=jQuery(".menu"),$project=jQuery(".project"),$topAnchor=jQuery(".topAnchor"),$projectImage=jQuery(".projectImage"),$astralBanner=jQuery(".astralBanner"),startVM=new StartViewModel,projectVM=new ProjectViewModel;ko.applyBindings(startVM,$homeNode),ko.applyBindings(projectVM,$projectNode),$project.on("mouseleave",function(){$projectImage.hide()}),$projectImage.on("mouseleave",function(){$projectImage.hide()}),$menu.on("click","li",function(a){var b=a.currentTarget.children[0].hash.split("/")[2];return showHome(b),!1}),$topAnchor.on("click",scrollToTop),void 0===window.location.hash&&showHome();var router=Router({"/project":{"/:slug":{on:showProject}},"/home":{"/:anchor":{on:showHome}},"/home":showHome});router.configure(),router.init();